This repository contains scripts to run our model of the global carbon cycle and Large Igneous Province (LIP) emplacement and weathering. The model is described in C. Minsky, R. Wordsworth, F. A. Macdonald, and A. H. Knoll (in review) "Neoproterozoic Snowball Earth Initiation from Silicate Weathering of a Large Igneous Province". This code reproduces all figures in the main text and supplementary text of the paper As a matter of courtesy, we request that people using this code please cite Minsky et al. (in review).

A graphical interface to the model is also available at [snowball-lip.streamlit.app](https://snowball-lip.streamlit.app/)

### Installation

Ensure you have Python installed (>=3.8). Install required dependencies using:

```bash
pip install -r requirements.txt
```

### Code Structure

- `dependencies.py` - Manages package loading
- `model.py` - Contains the main carbon cycle and LIP weathering model
- `bacgkround.py` - Reads in and processes background climate data from Krissansen-Totton et al. (2018), Foster et al. (2017), and Scotese et al. (2021)
- `MC_helpers.py` - Wrapper functions for the model that implement Monte Carlo sampling
- `defaults.py` - Defines the parameter space to be sampled and parameter metadata
- `save_data.py` - Helper functions to save data from Monte Carlo sampling in netCDF format and create summary statistics
- `slider_model.py` - Creates a GUI to run the model in the browser

### Running Analyses

The numeric prefix for each jupyter notebook corresponds to the relevant section of the paper. Notebooks ending with "generate" run the model in the relevant parameter space, while notebooks ending with "analyze" read in and plot data from those model runs.

Due to data storage and efficiency constraints, we have not uploaded the netCDF files generated by Monte Carlo sampling instances with 100k model runs, but they can be regenerated by running the files ending with "generate." The number of runs can be defined in the "iters" parameter at the top of "generate" notebooks; the "iters" parameter at the top of "analyze" notebooks must correspond to an existing file in the data folder. To run the code more quickly with a smaller number of model runs, change the "iters" parameter in corresponding generation and analysis notebooks to a smaller number. For convenience, we have uploaded sets of 10k model runs for testing, which can be plotted by changing "iters" to 1,000 in a given analysis notebook. To use these, download and unzip assets ending in `10k.zip` and add them to the `data` folder. To run `3.2_Phanerozoic_analyze.ipynb` without running `3.2_Phanerozoic_generate.ipynb`, download `Phanerozoic_filtered.zip` and add them to the `data` folder.

- `2_example_run.ipynb` - An example run of the model, creates Fig. 2
- `2.3_ice_albedo.ipynb` - Creates a bifurcation diagram (Fig. 3) to illustrate the chosen Snowball initiation threshold temperature
- `3.1_Franklin_generate.ipynb` - Monte Carlo sampling of the main parameter space for the Franklin LIP
- `3.1_Franklin_analyze.ipynb` - Analyzes the Franklin LIP model runs, creates Fig. 4, Fig. 5, and Fig. B1
- `3.2_Phanerozoic_generate.ipynb` - Runs the model for Phanerozoic LIP within the parameter space where the Franklin causes a Snowball
- `3.2_Phanerozoic_analyze.ipynb` - Analyzes the Phanerozoic LIP model runs, creates Fig. 6
- `3.3_CAMP_generate.ipynb` - Monte Carlo sampling of the parameter space for the CAMP with and without degassing, with and without erosion
- `3.3_CAMP_analyze.ipynb` - Analyzes the CAMP model runs, creates Fig. 7
- `3.4_geologic_generate.ipynb` - Runs the model over geologic time and Phanerozoic time
- `3.4_geologic_analyze.ipynb` - Creates Fig. 8
- `A.1_analytic.ipynb` - Plots the analytic solution derived in the appendix, creates Fig. A1

-------------------------

Contact e-mail: cminsky@g.harvard.edu